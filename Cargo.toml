[package]
name = "opentdf"
version = "0.3.0"
edition = "2021"
description = "Rust implementation of OpenTDF (Trusted Data Format)"
license = "Apache-2.0"
repository = "https://github.com/arkavo-org/opentdf-rs"

[dependencies]
zip = { version = "2.2.0", default-features = false, features = ["deflate"] }
serde_json = "1.0.132"
serde = { version = "1.0.214", features = ["derive"] }
base64 = "0.22.1"
hex = "0.4"
hmac = "0.12.1"
sha2 = "0.10.8"
thiserror = "1.0.67"
tempfile = "3.13.0"
aes-gcm = "0.10.3"
rand = "0.8.5"
chrono = { version = "0.4.35", features = ["serde"] }
uuid = { version = "1.8.0", features = ["v4", "serde"] }
lazy_static = "1.4.0"
# KAS client dependencies
reqwest = { version = "0.12", features = ["json"], optional = true }
tokio = { version = "1", features = ["full"], optional = true }
p256 = { version = "0.13", features = ["ecdsa", "pem"], optional = true }
hkdf = { version = "0.12", optional = true }
jwt-simple = { version = "0.12", optional = true }
rsa = { version = "0.9", features = ["sha2"], optional = true }
pkcs8 = { version = "0.10", features = ["pem"], optional = true }
sha1 = { version = "0.10", optional = true }

[dev-dependencies]
mockito = "1.5"
criterion = "0.5"

[workspace]
members = ["crates/mcp-server", "crates/wasm"]

[features]
default = []
mcp = []
kas = ["reqwest", "tokio", "p256", "hkdf", "jwt-simple", "rsa", "pkcs8", "sha1"]

[profile.release]
opt-level = "z"
lto = true
codegen-units = 1

[[example]]
name = "kas_decrypt"
required-features = ["kas"]

[[example]]
name = "create_tdf_with_kas"
required-features = ["kas"]

[[example]]
name = "create_tdf_platform"
required-features = ["kas"]

[[bench]]
name = "memory_builder"
harness = false
